#change in trend/time
#part to whole
with totals as (
select
	p.category,
	sum(f.sales_amount) as total_sales
	from [dbo].[gold.fact_sales] f
left join [dbo].[dim.products] p
on p.product_key=f.product_key
group by category
)
select 
     category,
	 total_sales,
	 sum(total_sales) over () over_all,
	 concat(round(cast((total_sales) as float)/sum(total_sales) over () *100,2),'%')  as percentage
	 from totals
